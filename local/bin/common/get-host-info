#!/bin/sh

PROCESSORS="`cat /proc/cpuinfo | grep ^processor | wc -l`"
PROCMODEL="`cat /proc/cpuinfo | grep '^model name' | cut -d: -f 2- | sed 's/^ *//g' | sort | uniq`"
MEMTOTAL="`cat /proc/meminfo | grep ^MemTotal | awk '{print $2}'`"
LOCALIP="`ip route get 1 | awk '{print $NF;exit}'`"
LOCALHOST="`hostname -f`"
KERNELNAME="`uname -s`"
MACHINENAME="`uname -m`"
GLV="`getconf  GNU_LIBC_VERSION 2>/dev/null | awk '{print $NF}' | awk -F. '{printf "%d%02d", $1, $2}'`"
case "$GLV" in
    205)    MACHINECLASS="EL5";;
    212)    MACHINECLASS="EL6";;
    217)    MACHINECLASS="EL7";;
    *)      MACHINECLASS="GLIBC_${GLV}";;
    --)     shift;break;;
    \?)     break;
    exit;;
esac

echo "${LOCALIP},${LOCALHOST},${KERNELNAME},${MACHINENAME},${PROCESSORS},${MEMTOTAL},'${PROCMODEL}',${MACHINECLASS}"

exit
